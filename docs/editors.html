<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/ruby-lsp/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/ruby-lsp/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/ruby-lsp/assets/js/vendor/lunr.min.js"></script> <script src="/ruby-lsp/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Editors | Ruby LSP</title> <meta name="generator" content="Jekyll v4.4.1" /> <meta property="og:title" content="Editors" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="An opinionated language server for Ruby. Batteries included!" /> <meta property="og:description" content="An opinionated language server for Ruby. Batteries included!" /> <link rel="canonical" href="https://shopify.github.io/ruby-lsp/editors.html" /> <meta property="og:url" content="https://shopify.github.io/ruby-lsp/editors.html" /> <meta property="og:site_name" content="Ruby LSP" /> <meta property="og:image" content="https://shopify.github.io/ruby-lsp/icon.png" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://shopify.github.io/ruby-lsp/icon.png" /> <meta property="twitter:title" content="Editors" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"An opinionated language server for Ruby. Batteries included!","headline":"Editors","image":"https://shopify.github.io/ruby-lsp/icon.png","url":"https://shopify.github.io/ruby-lsp/editors.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/ruby-lsp/" class="site-title lh-tight"> Ruby LSP </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Ruby LSP category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/ruby-lsp/" class="nav-list-link">Ruby LSP</a><ul class="nav-list"><li class="nav-list-item"><a href="/ruby-lsp/editors.html" class="nav-list-link">Editors</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in VS Code extension category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/ruby-lsp/vscode-extension.html" class="nav-list-link">VS Code extension</a><ul class="nav-list"><li class="nav-list-item"><a href="/ruby-lsp/test_explorer.html" class="nav-list-link">Test explorer</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Add-ons category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/ruby-lsp/add-ons.html" class="nav-list-link">Add-ons</a><ul class="nav-list"><li class="nav-list-item"><a href="/ruby-lsp/test_framework_addons.html" class="nav-list-link">Test framework add-ons</a></li></ul></li><li class="nav-list-item"><a href="/ruby-lsp/design-and-roadmap.html" class="nav-list-link">Design and roadmap</a></li><li class="nav-list-item"><a href="/ruby-lsp/semantic-highlighting.html" class="nav-list-link">Semantic Highlighting for Themes</a></li><li class="nav-list-item"><a href="/ruby-lsp/composed-bundle.html" class="nav-list-link">Composed Ruby LSP bundle</a></li></ul></li><li class="nav-list-item"><a href="/ruby-lsp/rails-add-on.html" class="nav-list-link">Rails add-on</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Troubleshooting category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/ruby-lsp/troubleshooting.html" class="nav-list-link">Troubleshooting</a><ul class="nav-list"><li class="nav-list-item"><a href="/ruby-lsp/version-managers.html" class="nav-list-link">Version Managers</a></li></ul></li><li class="nav-list-item"><a href="/ruby-lsp/contributing.html" class="nav-list-link">Contributing</a></li><li class="nav-list-item"><a href="/ruby-lsp/supported_versions.html" class="nav-list-link">Supported Versions Policy</a></li></ul> <ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/Shopify/ruby-lsp" class="nav-list-link external" target="_blank" rel="noopener noreferrer" > Ruby LSP on GitHub <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li><li class="nav-list-item external"> <a href="https://github.com/Shopify/ruby-lsp-rails" class="nav-list-link external" target="_blank" rel="noopener noreferrer" > Ruby LSP Rails on GitHub <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Ruby LSP" aria-label="Search Ruby LSP" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://shopify.github.io/ruby-lsp/invite" class="site-button" > Ruby DX Slack </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/Shopify/ruby-lsp/issues/new/choose" class="site-button" > Report an Issue </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/ruby-lsp/">Ruby LSP</a></li> <li class="breadcrumb-nav-list-item"><span>Editors</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="editors"> <a href="#editors" class="anchor-heading" aria-labelledby="editors"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Editors </h1> <p>This file contains community driven instructions on how to set up the Ruby LSP in editors other than VS Code. For VS Code, use the official <a href="https://marketplace.visualstudio.com/items?itemName=Shopify.ruby-lsp">Ruby LSP extension</a>.</p> <blockquote class="note"> <p>Some Ruby LSP features may be unavailable or limited due to incomplete implementations of the Language Server Protocol, such as dynamic feature registration, or <a href="https://github.com/Shopify/ruby-lsp/issues/1456">file watching</a>.</p> </blockquote> <p>If you wish to enable or disable features or configure other aspects of the language server, see <a href="#all-initialization-options">initialization options</a>.</p> <blockquote class="important"> <p>The command to launch the language server might depend on which editor and version manager combination you are using. In order to work properly, the Ruby LSP must be launched with the Ruby version being used by the project you are working on and with the correct Bundler environment set.</p> </blockquote> <p>If you normally launch your editor from the terminal in a shell session where the Ruby environment is already activated, then you can probably just use <code class="language-plaintext highlighter-rouge">ruby-lsp</code> as the command.</p> <p>If you’re seeing issues related to not finding the right gems or not being able to locate the <code class="language-plaintext highlighter-rouge">ruby-lsp</code> executable, then you may need to ensure that the environment is properly configured by the version manager before you try to run the <code class="language-plaintext highlighter-rouge">ruby-lsp</code> executable. How to do this will depend on which version manager you use. Here are some examples:</p> <p>If your version manager exposes a command to run an executable within the context of the current Ruby, use that:</p> <ul> <li><code class="language-plaintext highlighter-rouge">mise x -- ruby-lsp</code></li> <li><code class="language-plaintext highlighter-rouge">shadowenv exec -- ruby-lsp</code></li> </ul> <p>If your version manager creates gem executable shims that perform the automatic version switching, then use those:</p> <ul> <li><code class="language-plaintext highlighter-rouge">~/.rbenv/shims/ruby-lsp</code></li> <li><code class="language-plaintext highlighter-rouge">~/.asdf/shims/ruby-lsp</code></li> </ul> <p>If your version manager doesn’t provide either of those, then activate the environment and run the executable:</p> <ul> <li><code class="language-plaintext highlighter-rouge">chruby $(cat .ruby-version) &amp;&amp; ruby-lsp</code></li> </ul> <p>These strategies will ensure that the <code class="language-plaintext highlighter-rouge">ruby-lsp</code> executable is invoked with the correct Ruby version, <code class="language-plaintext highlighter-rouge">GEM_HOME</code> and <code class="language-plaintext highlighter-rouge">GEM_PATH</code>, which are necessary for proper integration with your project.</p> <h2 id="all-initialization-options"> <a href="#all-initialization-options" class="anchor-heading" aria-labelledby="all-initialization-options"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> All initialization options </h2> <p>Each LSP client can control various abilities of the LSP at startup. The following JSON dictionary contains all of the available initialization options. Generally, editor LSP clients will configure LSP servers using a dictionary in their configuration languages (JSON, Lua, ELisp, etc.).</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"initializationOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"enabledFeatures"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"codeActions"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"codeLens"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"completion"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"definition"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"diagnostics"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"documentHighlights"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"documentLink"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"documentSymbols"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"foldingRanges"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"formatting"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"hover"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"inlayHint"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"onTypeFormatting"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"selectionRanges"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"semanticHighlighting"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"signatureHelp"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"typeHierarchy"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"workspaceSymbol"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"featuresConfiguration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"inlayHint"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"implicitHashValue"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"implicitRescue"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"indexing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"excludedPatterns"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"path/to/excluded/file.rb"</span><span class="p">],</span><span class="w">
      </span><span class="nl">"includedPatterns"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"path/to/included/file.rb"</span><span class="p">],</span><span class="w">
      </span><span class="nl">"excludedGems"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"gem1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"gem2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"etc."</span><span class="p">],</span><span class="w">
      </span><span class="nl">"excludedMagicComments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"compiled:true"</span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"formatter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auto"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"linters"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"experimentalFeaturesEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <!-- When adding a new editor to the list, either link directly to a website containing the instructions or link to a new H2 header in this file containing the instructions. --> <ul> <li><a href="https://emacs-lsp.github.io/lsp-mode/page/lsp-ruby-lsp/">Emacs LSP Mode</a></li> <li><a href="#emacs-eglot">Emacs Eglot</a></li> <li><a href="#neovim">Neovim LSP</a></li> <li><a href="#lazyvim-lsp">LazyVim LSP</a></li> <li><a href="#sublime-text-lsp">Sublime Text LSP</a></li> <li><a href="#zed">Zed</a></li> <li><a href="#rubymine">RubyMine</a></li> <li><a href="#kate">Kate</a></li> <li><a href="#helix">Helix</a></li> </ul> <h2 id="emacs-eglot"> <a href="#emacs-eglot" class="anchor-heading" aria-labelledby="emacs-eglot"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Emacs Eglot </h2> <p><a href="https://github.com/joaotavora/eglot">Eglot</a> runs solargraph server by default. To set it up with ruby-lsp you need to put that in your init file:</p><pre><code class="language-el">(with-eval-after-load 'eglot
 (add-to-list 'eglot-server-programs '((ruby-mode ruby-ts-mode) "ruby-lsp")))
</code></pre><p>When you run <code class="language-plaintext highlighter-rouge">eglot</code> command it will run <code class="language-plaintext highlighter-rouge">ruby-lsp</code> process for you.</p> <h2 id="neovim"> <a href="#neovim" class="anchor-heading" aria-labelledby="neovim"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Neovim </h2> <p><strong>Note</strong>: Ensure that you are using Neovim 0.10 or newer.</p> <h3 id="nvim-lspconfig"> <a href="#nvim-lspconfig" class="anchor-heading" aria-labelledby="nvim-lspconfig"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> nvim-lspconfig </h3> <p>The <a href="https://github.com/neovim/nvim-lspconfig/blob/master/lua/lspconfig/configs/ruby_lsp.lua">nvim-lspconfig</a> plugin has support for Ruby LSP.</p> <p>The Ruby LSP can be configured using the <code class="language-plaintext highlighter-rouge">init_options</code> key when setting up the LSP.</p> <p>A great example of this configuration style is enabling the Standard add-on for the Ruby LSP to enable formatting and pull-style diagnostics. The following snippet enables <code class="language-plaintext highlighter-rouge">standard</code> for both formatting and pull-diagnostic linting.</p> <div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">lspconfig</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">'lspconfig'</span><span class="p">)</span>
<span class="n">lspconfig</span><span class="p">.</span><span class="n">ruby_lsp</span><span class="p">.</span><span class="n">setup</span><span class="p">({</span>
  <span class="n">init_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="s1">'standard'</span><span class="p">,</span>
    <span class="n">linters</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'standard'</span> <span class="p">},</span>
  <span class="p">},</span>
<span class="p">})</span>
</code></pre></div></div> <p>To configure an add-on, add the configuration <code class="language-plaintext highlighter-rouge">addonSettings</code> within <code class="language-plaintext highlighter-rouge">init_options</code>, for example:</p> <div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">init_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">addonSettings</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">[</span><span class="s2">"Ruby LSP Rails"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">enablePendingMigrationsPrompt</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">},</span>
  <span class="p">},</span>
</code></pre></div></div> <h3 id="mason"> <a href="#mason" class="anchor-heading" aria-labelledby="mason"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mason </h3> <p>You can use <a href="https://github.com/williamboman/mason.nvim">mason.nvim</a>, along with <a href="https://github.com/williamboman/mason-lspconfig.nvim">mason-lspconfig.nvim</a>:</p> <div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">capabilities</span> <span class="o">=</span> <span class="n">vim</span><span class="p">.</span><span class="n">lsp</span><span class="p">.</span><span class="n">protocol</span><span class="p">.</span><span class="n">make_client_capabilities</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">mason_lspconfig</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s2">"mason-lspconfig"</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">ruby_lsp</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">}</span>

<span class="n">mason_lspconfig</span><span class="p">.</span><span class="n">setup</span> <span class="p">{</span>
  <span class="n">ensure_installed</span> <span class="o">=</span> <span class="n">vim</span><span class="p">.</span><span class="n">tbl_keys</span><span class="p">(</span><span class="n">servers</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">mason_lspconfig</span><span class="p">.</span><span class="n">setup_handlers</span> <span class="p">{</span>
  <span class="k">function</span><span class="p">(</span><span class="n">server_name</span><span class="p">)</span>
    <span class="nb">require</span><span class="p">(</span><span class="s2">"lspconfig"</span><span class="p">)[</span><span class="n">server_name</span><span class="p">].</span><span class="n">setup</span> <span class="p">{</span>
      <span class="n">capabilities</span> <span class="o">=</span> <span class="n">capabilities</span><span class="p">,</span>
      <span class="n">on_attach</span> <span class="o">=</span> <span class="n">on_attach</span><span class="p">,</span>
      <span class="n">settings</span> <span class="o">=</span> <span class="n">servers</span><span class="p">[</span><span class="n">server_name</span><span class="p">],</span>
      <span class="n">filetypes</span> <span class="o">=</span> <span class="p">(</span><span class="n">servers</span><span class="p">[</span><span class="n">server_name</span><span class="p">]</span> <span class="ow">or</span> <span class="p">{}).</span><span class="n">filetypes</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="k">end</span>
<span class="p">}</span>
</code></pre></div></div> <blockquote class="important"> <p>Using Mason to manage your installation of the Ruby LSP may cause errors</p> </blockquote> <p>Mason installs the Ruby LSP in a folder shared among all your Rubies. Some of the Ruby LSP dependencies are C extensions, and they rely on the Ruby ABI to look and act a certain way when they were linked to Ruby. This causes issues when a shared folder is used.</p> <p>See <a href="https://github.com/williamboman/mason.nvim/issues/1292">this issue</a> for further information.</p> <h3 id="built-in-vimlsp"> <a href="#built-in-vimlsp" class="anchor-heading" aria-labelledby="built-in-vimlsp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Built-In vim.lsp </h3> <p class="note">Ensure that you are using NeoVim 0.11 or newer.</p> <p>You can also configure the Ruby LSP without the nvim-lspconfig plugin. Create an <code class="language-plaintext highlighter-rouge">lsp</code> directory inside your config directory and create a file <code class="language-plaintext highlighter-rouge">ruby-lsp.lua</code> inside it with the following content:</p> <div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- on Linux and macOS the default location is ~/.config/nvim/lsp/ruby-lsp.lua</span>
<span class="k">return</span> <span class="p">{</span>

  <span class="n">filetypes</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"ruby"</span> <span class="p">},</span>

  <span class="n">cmd</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"ruby-lsp"</span> <span class="p">}</span> <span class="c1">-- or { "bundle", "exec", "ruby-lsp" },</span>

  <span class="n">root_markers</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"Gemfile"</span><span class="p">,</span> <span class="s2">".git"</span> <span class="p">},</span>
  
  <span class="n">init_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="s1">'standard'</span><span class="p">,</span>
    <span class="n">linters</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'standard'</span> <span class="p">},</span>
    <span class="n">addonSettings</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">[</span><span class="s2">"Ruby LSP Rails"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">enablePendingMigrationsPrompt</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div> <p>Then you need to enable it, e.g., inside <code class="language-plaintext highlighter-rouge">init.lua</code>:</p> <div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vim</span><span class="p">.</span><span class="n">lsp</span><span class="p">.</span><span class="n">enable</span><span class="p">(</span><span class="s2">"ruby-lsp"</span><span class="p">)</span>
</code></pre></div></div> <h3 id="additional-setup-optional"> <a href="#additional-setup-optional" class="anchor-heading" aria-labelledby="additional-setup-optional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Additional setup (optional) </h3> <p><code class="language-plaintext highlighter-rouge">rubyLsp/workspace/dependencies</code> is a custom method currently supported only in the VS Code plugin. The following snippet adds <code class="language-plaintext highlighter-rouge">ShowRubyDeps</code> command to show dependencies in the quickfix list.</p> <div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="k">function</span> <span class="nf">add_ruby_deps_command</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bufnr</span><span class="p">)</span>
  <span class="n">vim</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">nvim_buf_create_user_command</span><span class="p">(</span><span class="n">bufnr</span><span class="p">,</span> <span class="s2">"ShowRubyDeps"</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">params</span> <span class="o">=</span> <span class="n">vim</span><span class="p">.</span><span class="n">lsp</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">make_text_document_params</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">showAll</span> <span class="o">=</span> <span class="n">opts</span><span class="p">.</span><span class="n">args</span> <span class="o">==</span> <span class="s2">"all"</span>

    <span class="n">client</span><span class="p">.</span><span class="n">request</span><span class="p">(</span><span class="s2">"rubyLsp/workspace/dependencies"</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nb">error</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">error</span> <span class="k">then</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Error showing deps: "</span> <span class="o">..</span> <span class="nb">error</span><span class="p">)</span>
        <span class="k">return</span>
      <span class="k">end</span>

      <span class="kd">local</span> <span class="n">qf_list</span> <span class="o">=</span> <span class="p">{}</span>
      <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">item</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">do</span>
        <span class="k">if</span> <span class="n">showAll</span> <span class="ow">or</span> <span class="n">item</span><span class="p">.</span><span class="n">dependency</span> <span class="k">then</span>
          <span class="nb">table.insert</span><span class="p">(</span><span class="n">qf_list</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">text</span> <span class="o">=</span> <span class="nb">string.format</span><span class="p">(</span><span class="s2">"%s (%s) - %s"</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">version</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="n">dependency</span><span class="p">),</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">item</span><span class="p">.</span><span class="n">path</span>
          <span class="p">})</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="n">vim</span><span class="p">.</span><span class="n">fn</span><span class="p">.</span><span class="n">setqflist</span><span class="p">(</span><span class="n">qf_list</span><span class="p">)</span>
      <span class="n">vim</span><span class="p">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">'copen'</span><span class="p">)</span>
    <span class="k">end</span><span class="p">,</span> <span class="n">bufnr</span><span class="p">)</span>
  <span class="k">end</span><span class="p">,</span>
  <span class="p">{</span><span class="n">nargs</span> <span class="o">=</span> <span class="s2">"?"</span><span class="p">,</span> <span class="n">complete</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span> <span class="k">return</span> <span class="p">{</span><span class="s2">"all"</span><span class="p">}</span> <span class="k">end</span><span class="p">})</span>
<span class="k">end</span>

<span class="nb">require</span><span class="p">(</span><span class="s2">"lspconfig"</span><span class="p">).</span><span class="n">ruby_lsp</span><span class="p">.</span><span class="n">setup</span><span class="p">({</span>
  <span class="n">on_attach</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
    <span class="n">add_ruby_deps_command</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
  <span class="k">end</span><span class="p">,</span>
<span class="p">})</span>
</code></pre></div></div> <h2 id="lazyvim-lsp"> <a href="#lazyvim-lsp" class="anchor-heading" aria-labelledby="lazyvim-lsp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LazyVim LSP </h2> <p><a href="https://github.com/LazyVim/LazyVim/pull/3652">As of v12.33.0</a>, Ruby LSP is the default LSP for Ruby.</p> <p>To ensure the correct Ruby version is selected, we recommend disabling the <code class="language-plaintext highlighter-rouge">mason</code> option and specifying the appropriate command for your Ruby version manager as an absolute path. For example:</p> <div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="p">{</span>
  <span class="p">{</span>
    <span class="s2">"neovim/nvim-lspconfig"</span><span class="p">,</span>
    <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">ruby_lsp</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">mason</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
          <span class="n">cmd</span> <span class="o">=</span> <span class="p">{</span> <span class="n">vim</span><span class="p">.</span><span class="n">fn</span><span class="p">.</span><span class="n">expand</span><span class="p">(</span><span class="s2">"~/.asdf/shims/ruby-lsp"</span><span class="p">)</span> <span class="p">},</span>
        <span class="p">},</span>
      <span class="p">},</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">}</span>

</code></pre></div></div> <h2 id="sublime-text-lsp"> <a href="#sublime-text-lsp" class="anchor-heading" aria-labelledby="sublime-text-lsp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sublime Text LSP </h2> <p>To configure the Ruby LSP using <a href="https://github.com/sublimelsp/LSP">LSP for Sublime Text</a>, add the following configuration to your LSP client configuration:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"clients"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"ruby-lsp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"command"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"ruby-lsp"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"selector"</span><span class="p">:</span><span class="w"> </span><span class="s2">"source.ruby"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"initializationOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"enabledFeatures"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"diagnostics"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"experimentalFeaturesEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Restart LSP or Sublime Text and <code class="language-plaintext highlighter-rouge">ruby-lsp</code> will automatically activate when opening ruby files.</p> <h2 id="zed"> <a href="#zed" class="anchor-heading" aria-labelledby="zed"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Zed </h2> <p>Zed has support for the Ruby LSP through the <a href="https://github.com/zed-extensions/ruby">Ruby extension</a>.</p> <p>Documentation can be found in <a href="https://zed.dev/docs/languages/ruby#setting-up-ruby-lsp">Setting up Ruby LSP</a>.</p> <h2 id="rubymine"> <a href="#rubymine" class="anchor-heading" aria-labelledby="rubymine"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RubyMine </h2> <p>You can use the Ruby LSP with RubyMine (or IntelliJ IDEA Ultimate) through the following plugin.</p> <p>Note that there might be overlapping functionality when using it with RubyMine, given that the IDE provides similar features as the ones coming from the Ruby LSP.</p> <p><a href="https://plugins.jetbrains.com/plugin/24413-ruby-lsp">Ruby LSP plugin</a></p> <h2 id="kate"> <a href="#kate" class="anchor-heading" aria-labelledby="kate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kate </h2> <p><a href="https://docs.kde.org/stable5/en/kate/kate/kate-application-plugin-lspclient.html">The LSP Client Plugin</a> for Kate is configured by default to use Solargraph for Ruby. To use it with Ruby LSP, you can override particular configuration items in the “User Server Settings” in the LSP Client plugin as shown below:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"servers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ruby"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"command"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"ruby-lsp"</span><span class="p">],</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://github.com/Shopify/ruby-lsp"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>In the Kate settings, under the “LSP-Client” tab, the option “Incrementally synchronize documents with the LSP server” must be enabled. Otherwise, errors like <a href="https://github.com/Shopify/ruby-lsp/issues/3148">this</a> can occur when editing a Ruby file.</p> <p>Kate will start an instance of the Ruby LSP server in the background for any Ruby project matching the <code class="language-plaintext highlighter-rouge">rootIndicationFileNames</code>. If starting Ruby LSP succeeds, the entries in the LSP-Client menu are activated. Otherwise the error output can be inspected in the Output window.</p> <h2 id="helix"> <a href="#helix" class="anchor-heading" aria-labelledby="helix"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Helix </h2> <p>To configure the Ruby LSP in Helix you first need to define it as a language server and then set it as the main language server for Ruby. This will also set ruby-lsp to be used as a formatter with its built-in rubocop integration.</p> <div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># languages.toml</span>

<span class="nn">[language-server.ruby-lsp]</span>
<span class="py">command</span> <span class="p">=</span> <span class="s">"ruby-lsp"</span>
<span class="py">config</span> <span class="o">=</span> <span class="p">{</span> <span class="py">diagnostics</span> <span class="p">=</span> <span class="kc">true</span><span class="p">,</span> <span class="py">formatting</span> <span class="p">=</span> <span class="kc">true</span> <span class="p">}</span>

<span class="nn">[[language]]</span>
<span class="py">name</span> <span class="p">=</span> <span class="s">"ruby"</span>
<span class="py">language-servers</span> <span class="p">=</span> <span class="p">[</span><span class="s">"ruby-lsp"</span><span class="p">]</span>
<span class="py">auto-format</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></div></div> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
